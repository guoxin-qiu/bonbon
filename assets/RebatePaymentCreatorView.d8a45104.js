var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,r=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,n=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(l)for(var a of l(t))d.call(t,a)&&r(e,a,t[a]);return e},o=(e,l)=>t(e,a(l));import{_ as u}from"./index.9b869bd5.js";import{d as s,r as c,bj as f,aV as p,aW as m,aS as y,a as b,a$ as h,az as w,aX as v,cf as _,ay as x,ct as P,cs as g,a_ as V,bn as k,aQ as C,b0 as A,bk as D,bR as R,aR as U,cl as j,bK as q}from"./index.44eff430.js";import{c as K,r as O}from"./routerHelper.692f5c09.js";import{a as B}from"./retail-rebate-payment.service.9bb518f4.js";import{_ as T}from"./index.69084706.js";import{_ as Q}from"./index.a39b0902.js";import{_ as L}from"./index.b9b9b125.js";import{_ as N}from"./index.dd62f48c.js";import{_ as S}from"./index.4d216ae4.js";import{_ as E}from"./index.eb643f6e.js";import{g as M,a as G}from"./vxeTableHelper.6baae079.js";import{_ as F}from"./index.36147ed9.js";import{_ as H}from"./index.9ab52a84.js";import{_ as Y}from"./index.efd20b46.js";import{_ as W}from"./index.9fcc5db4.js";import{Q as z}from"./vue-quill.snow.40f2bfe1.js";import{_ as I,C as X}from"./CollapsePanel.5cf4e0c3.js";import"./dayjs.min.7438ea6f.js";import"./master-data.service.95993c0c.js";import"./retail-master-data.service.de057498.js";const $=h(s({__name:"MainFormView",props:{data:{type:null,required:!0},editable:{type:Boolean,required:!0}},setup(e){const t=e,a=c(),l={type:[{required:!0}],year:[{required:!0}],name:[{required:!0}],customerCategory:[{required:!0}],productMix:[{required:!0}],paymentRatio:[{required:!0}],startQuarter:[{required:!0}],endQuarter:[{required:!0}],windowPeriodStart:[{required:!0}],windowPeriodEnd:[{required:!0}]};return(e,i)=>{const d=E,r=f("vxe-form-item"),n=S,o=f("vxe-input"),u=N,s=L,c=Q,h=f("vxe-switch"),w=T,v=f("vxe-form");return p(),m(v,{"title-align":"right","title-width":"180",data:t.data,rules:l,ref_key:"xForm",ref:a},{default:y((()=>[b(r,{field:"type",title:"报告类型",span:11},{default:y((({data:e})=>[b(d,{modelValue:e.type,"onUpdate:modelValue":t=>e.type=t,disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"year",title:"年份",span:11},{default:y((({data:e})=>[b(n,{modelValue:e.year,"onUpdate:modelValue":t=>e.year=t,disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"name",title:"报告名称",span:22},{default:y((({data:e})=>[b(o,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"customerCategory",title:"KA属性",span:11},{default:y((({data:e})=>[b(u,{modelValue:e.customerCategory,"onUpdate:modelValue":t=>e.customerCategory=t,multiple:"",disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"customerLevelType",title:"客户级别类型",span:11},{default:y((({data:e})=>[b(s,{modelValue:e.customerLevelType,"onUpdate:modelValue":t=>e.customerLevelType=t,disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"productMix",title:"产品组合",span:11},{default:y((({data:e})=>[b(c,{modelValue:e.productMix,"onUpdate:modelValue":t=>e.productMix=t,multiple:"",disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"paymentRatio",title:"支付比例",span:11},{default:y((({data:e})=>[b(o,{modelValue:e.paymentRatio,"onUpdate:modelValue":t=>e.paymentRatio=t,type:"number",disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"automaticDeduction",title:"是否自动抵扣",span:11,"title-prefix":{content:"开启后，系统会根据总部+产品+Entity，自动填充扣减金额（待回收）字段，逻辑详见汇总至总部的对应字段。"}},{default:y((({data:e})=>[b(h,{modelValue:e.automaticDeduction,"onUpdate:modelValue":t=>e.automaticDeduction=t,disabled:!t.editable,"open-label":"是","close-label":"否","open-value":"是","close-value":"否"},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"canRecycle",title:"是否可以回收",span:11,"title-prefix":{content:"为了业务上区分季度年度的操作。 是，则KA可操作确认回收/取消回收；否，KA不可操作回收。\n          回收逻辑：实际支付金额要是负数才可回收。将负数的绝对值根据季度+总部+产品+Entity存入返利抵扣表中。\n          必须经过KA的操作，系统不自动将负值存入返利抵扣表。"}},{default:y((({data:e})=>[b(h,{modelValue:e.canRecycle,"onUpdate:modelValue":t=>e.canRecycle=t,disabled:!t.editable,"open-label":"是","close-label":"否","open-value":"是","close-value":"否"},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"automaticYearly",title:"是否年度追溯",span:11,"title-prefix":{content:"是，则可以选择扣减报告，否，则不可以选择扣减报告。\n        如果是年度追溯，则所有数据汇总到报告结束季度。\n        举例：是否年度追溯选择是，开始季度2022Q1，结束季度2022Q4，方案按各个Q匹配，？？？未完待续"}},{default:y((({data:e})=>[b(h,{modelValue:e.automaticYearly,"onUpdate:modelValue":t=>e.automaticYearly=t,disabled:!t.editable,"open-label":"是","close-label":"否","open-value":"是","close-value":"否"},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{span:11}),b(r,{field:"startQuarter",title:"报告开始季度",span:11},{default:y((({data:e})=>[b(w,{modelValue:e.startQuarter,"onUpdate:modelValue":t=>e.startQuarter=t,disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"endQuarter",title:"报告结束季度",span:11},{default:y((({data:e})=>[b(w,{modelValue:e.endQuarter,"onUpdate:modelValue":t=>e.endQuarter=t,disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"startDate",title:"报告开始日期",span:11,titlePrefix:{content:"根据报告开始季度自动赋值"}},{default:y((({data:e})=>[b(o,{modelValue:e.startDate,"onUpdate:modelValue":t=>e.startDate=t,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),b(r,{field:"endDate",title:"报告结束日期",span:11,titlePrefix:{content:"根据报告结束季度自动赋值"}},{default:y((({data:e})=>[b(o,{modelValue:e.endDate,"onUpdate:modelValue":t=>e.endDate=t,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),b(r,{field:"windowPeriodStart",title:"窗口期开始",span:11},{default:y((({data:e})=>[b(o,{modelValue:e.windowPeriodStart,"onUpdate:modelValue":t=>e.windowPeriodStart=t,type:"datetime",disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),b(r,{field:"windowPeriodEnd",title:"窗口期结束",span:11},{default:y((({data:e})=>[b(o,{modelValue:e.windowPeriodEnd,"onUpdate:modelValue":t=>e.windowPeriodEnd=t,type:"datetime",disabled:!t.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1})])),_:1},8,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/MainFormView.vue"]]),J=h(s({__name:"DeductReport",props:{data:{type:null,required:!0},editable:{type:Boolean,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,columns:[{field:"name",title:"报告名称",width:300},{field:"year",title:"年份",width:100},{field:"startQuarter",title:"结算开始季度",width:150},{field:"endQuarter",title:"结算结束季度",width:150},{field:"type",title:"报告类型",width:150},{field:"customerCategory",title:"KA属性",width:100},{field:"customerLevelType",title:"客户级别类型",width:150},{field:"productMix",title:"产品组合",width:300},{title:"操作",align:"center",width:120,fixed:"right",slots:{default:"operations"}}]}));function i(){G("审批通过的结算报告，系统不做范围筛选；选择后可以删除掉；")}function d(){G("删除扣减结算报告")}return(e,r)=>{const n=f("vxe-button"),o=f("vxe-grid");return p(),m(o,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{toolbar_buttons:y((()=>[t.editable?(p(),m(n,{key:0,status:"primary",content:"选择结算报告",onClick:i})):v("v-if",!0)])),operations:y((()=>[t.editable?(p(),m(n,{key:0,status:"danger",onClick:d,content:"删除"})):v("v-if",!0)])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/DeductReport.vue"]]),Z=h(s({__name:"ResultByHeadquarter",props:{data:{type:null,required:!0},isAppealing:{type:Boolean,required:!0},isChecking:{type:Boolean,required:!0},isDraft:{type:Boolean,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,formConfig:{items:[{folding:!1,itemRender:{},slots:{default:"search_headquarter"}},{folding:!1,slots:{default:"search_recycleType"}},{folding:!1,slots:{default:"search_payType"}},{folding:!1,slots:{default:"search_status"}},{folding:!0,itemRender:{},slots:{default:"search_product"}},{folding:!0,itemRender:{},slots:{default:"search_payAccount"}},{collapseNode:!0,itemRender:{},slots:{default:"search_operation"}}]},columns:[{field:"checkbox",type:"checkbox",width:50,align:"center",fixed:"left"},{field:"quarter",title:"季度",width:150},{field:"headquarterCode",title:"总部编码",width:150},{field:"headquarterName",title:"总部名称",width:300},{field:"customerCategory",title:"KA属性",width:150,titlePrefix:{content:"总部的KA属性"}},{field:"productMix",title:"产品组合",width:300,titlePrefix:{content:"流向中的SKU和Q匹配产品组合"}},{field:"entity",title:"Entity",width:150},{field:"productCode",title:"产品编码",width:150,titlePrefix:{content:"流向中的SKU关联的产品"}},{field:"productName",title:"产品名称",width:300},{field:"agreementTargetAmount",title:"协议目标金额",width:150,titlePrefix:{content:"按总部+Q+产品组从协议目标中获取"}},{field:"achieveAmountAll",title:"产品组合实际达成金额",width:200,titlePrefix:{content:"流向中by产品组的SUM(销量*考核价)"}},{field:"achieveRatioAll",title:"产品组合实际达成率",width:200,titlePrefix:{content:"[产品组合达成金额]/[协议目标金额]，保留4位小数，不四舍五入"},formatter:({cellValue:e})=>P(e)},{field:"achieveRatioCapping",title:"达成率封顶值",width:150,titlePrefix:{content:"去对应Q的KA属性包含总部属性的方案中查找达成率封顶值"},formatter:({cellValue:e})=>P(e)},{field:"adjustAchieveRatio",title:"调整后达成率",width:250,titlePrefix:{content:"[产品组合实际达成率]>[达成率封顶值]?[达成率封顶值]:[产品组合实际达成率]"},formatter:({cellValue:e})=>P(e)},{field:"adjustAchieveAmountAll",title:"调整后产品组合达成金额",width:250,titlePrefix:{content:"[产品组合实际达成率]>[达成率封顶值]? [协议目标金额]*[调整后产品组合达成率]:[产品组合达成金额]"},formatter:({cellValue:e})=>g(e)},{field:"achieveAmount",title:"项目达成金额",width:150,titlePrefix:{content:"流向中by产品组合+产品的SUM(SKU销量*考核价)"}},{field:"adjustAchieveAmount",title:"调整后达成金额",width:150,titlePrefix:{content:"考虑从公式中获取计算规则；总部调整后产品组合达成金额*（产品原始达成金额/产品组合原始达成金额）"}},{field:"growthRate",title:"销售增长率",width:150,titlePrefix:{content:"[产品组合达成金额]/[产品组合达成基数] - 1"},formatter:({cellValue:e})=>P(e)},{field:"growthRateCap",title:"增长率封顶值",width:150,titlePrefix:{content:"总部by产品组的增长率封顶值"},formatter:({cellValue:e})=>P(e)},{field:"adjustGrowthRateCap",title:"调整后的增长率",width:150,titlePrefix:{content:"[实际增长率]>[增长率封顶值]?[增长率封顶值]:[实际增长率]"},formatter:({cellValue:e})=>P(e)},{field:"discountFactor",title:"折扣系数",width:150,titlePrefix:{content:"Q+KA属性(如有)+客户级别(如有)+总部(如有)+产品组合(如有)+产品(如有)匹配折扣系数；使用实际达成率!"}},{field:"discountRatio",title:"折扣比例",width:150,titlePrefix:{content:"Q+总部+产品组合+产品（如有），匹配折扣比例"},formatter:({cellValue:e})=>P(e)},{field:"basePaymentRatio",title:"存量支付比例",width:150,titlePrefix:{content:"Q+KA属性(如有)+客户级别(如有)+总部(如有)+产品组合(如有)+产品(如有)匹配；使用实际达成率/增长率"},formatter:({cellValue:e})=>P(e)},{field:"incrementPaymentRatio",title:"增量支付比例",width:150,titlePrefix:{content:"Q+KA属性(如有)+客户级别(如有)+总部(如有)+产品组合(如有)+产品(如有)匹配；使用实际达成率/增长率"},formatter:({cellValue:e})=>P(e)},{field:"rebateAmount",title:"返利金额",width:150,titlePrefix:{content:"系统根据方案配置的规则和公式进行计算"}},{field:"paymentRatio",title:"支付比例",width:150,titlePrefix:{content:"结算报告中的支付比例"}},{field:"paymentAmount",title:"支付金额",width:150,titlePrefix:{content:"返利金额*支付比例"}},{field:"deductPaidAmount",title:"扣减金额(已支付)",width:200,titlePrefix:{content:"选择的扣减报告中的【支付金额】总和，by总部+产品组合+产品+Entity进行扣减"}},{field:"deductRecycleAmount",title:"扣减金额(待回收)",width:200,titlePrefix:{content:"自动抵扣被选中，按总部+产品+Entity从抵扣记录表汇算得出，由最早的季度开始抵扣，直到所有待抵扣金额都扣光"}},{field:"actuallyAmount",title:"实际支付金额",width:150,titlePrefix:{content:"支付金额 - 扣减金额(已支付)- 扣减金额(待回收)"}},{field:"actuallyAmountWithTax",title:"实际支付金额(含税)",width:200,titlePrefix:{content:"实际支付金额*固定税率"}},{field:"paymentStartDate",title:"支付开始日期",width:150,titlePrefix:{content:"结算数据中Q对应的开始日期"}},{field:"paymentEndDate",title:"支付结束日期",width:150,titlePrefix:{content:"结算数据中Q对应的结束日期"}},{field:"paymentDealerCode",title:"支付商业编码",width:150,titlePrefix:{content:"总部关联的转支付经销商信息"}},{field:"paymentDealerName",title:"支付商业名称",width:150},{field:"forwardLevel1DealerCode",title:"一级转支付经销商编码",width:200},{field:"forwardLevel1DealerName",title:"一级转支付经销商名称",width:200},{field:"forwardLevel2DealerCode",title:"二级转支付经销商编码",width:200},{field:"forwardLevel2DealerName",title:"二级转支付经销商名称",width:200},{field:"contractPartyCode",title:"零售签约主体编码",width:180,titlePrefix:{content:"总部信息中的签约主体"}},{field:"contractParty",title:"零售签约主体名称",width:180,titlePrefix:{content:"总部信息中的签约主体"}},{field:"payStatus",title:"支付状态",width:150,titlePrefix:{content:'此字段为零售KA反馈字段，未反馈为空。所有数据必须由零售KA反馈为"支付"或"不支付"'}},{field:"remark",title:"支付状态反馈理由",width:200,titlePrefix:{content:"此字段为零售KA对是否支付反馈字段，未反馈为空"}},{field:"recycleStatus",title:"回收状态",width:150,titlePrefix:{content:"如果实际支付金额是负数，则回收状态为未回收。有KA决定是否回收，状态会变成回收/不回收。所有的回收状态都要更改，在提交时不能为未回收"}},{field:"recycleAppealRemark",title:"回收状态反馈理由",width:180,titlePrefix:{content:"反馈时，如果不回收，填写此字段"}},{field:"status",title:"核验状态",width:150,titlePrefix:{content:"核验的结果状态"}},{title:"操作",align:"center",width:150,fixed:t.isAppealing?"right":void 0,slots:{default:"operations"}}]}));return(e,i)=>{const d=W,r=Y,n=H,o=F,u=f("vxe-button"),s=f("vxe-grid");return p(),m(s,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{search_headquarter:y((()=>[b(d)])),search_product:y((()=>[b(r)])),search_payAccount:y((()=>[b(n,{placeholder:"支付商业"})])),search_recycleType:y((()=>[b(o,{type:"回收状态",placeholder:"回收状态"})])),search_payType:y((()=>[b(o,{type:"支付状态",placeholder:"支付状态"})])),search_status:y((()=>[b(o)])),search_operation:y((()=>[b(u,{status:"primary",type:"submit"},{default:y((()=>[V("搜索")])),_:1})])),operations:y((()=>[t.isAppealing?(p(),m(u,{key:0,status:"primary",content:"标记回收",onClick:i[0]||(i[0]=e=>x(G)("当实际支付返利金额（无税）小于0时才显示此按钮，才可对该数据进行回收确认操作。\n            点击后弹出确认窗口 是否回收：回收/不回收，并填写原因字段。"))})):v("v-if",!0)])),toolbar_buttons:y((()=>[t.isDraft?(p(),m(u,{key:0,status:"primary",content:"标记不年度追溯",onClick:i[1]||(i[1]=e=>x(G)("标记为不做年度追溯，只有是否年度追溯选择了是才会有这个按钮。选择后，在后续核验过程中，KA不可见此标记数据。可以批量操作，按勾选，或者按查询条件"))})):v("v-if",!0),t.isAppealing?(p(),m(u,{key:1,status:"primary",content:"标记支付",onClick:i[2]||(i[2]=e=>x(G)("标记为支付或不支付，针对所有数据，需要填写备注。"))})):v("v-if",!0),t.isAppealing?(p(),m(u,{key:2,status:"primary",content:"提交数据",onClick:i[3]||(i[3]=e=>x(G)("将调整后的数据提交到数据团队核验"))})):v("v-if",!0),t.isChecking?(p(),m(u,{key:3,status:"warning",content:"数据核验",onClick:i[4]||(i[4]=e=>x(G)("核验支付标记和回收情况。点击后，弹出核验通过或核验拒绝，并填写原因"))})):v("v-if",!0),t.isChecking?(p(),m(u,{key:4,status:"warning",content:"标记完成",onClick:i[5]||(i[5]=e=>x(G)("数据团队操作，只能对核验通过或核验拒绝的数据进行标记完成。标记完成后，数据冻结，KA不能再修改或申诉。"))})):v("v-if",!0)])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/ResultByHeadquarter.vue"]]),ee=h(s({__name:"ResultByBranch",props:{data:{type:null,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,columns:[{field:"checkbox",type:"checkbox",width:50,align:"center",fixed:"left"},{field:"quarter",title:"季度",width:150},{field:"headquarterCode",title:"总部编码",width:150},{field:"headquarterName",title:"总部名称",width:300},{field:"branchCode",title:"分部编码",width:150},{field:"branchName",title:"分部名称",width:300},{field:"customerCategory",title:"KA属性",width:150,titlePrefix:{content:"分部的KA属性"}},{field:"productMix",title:"产品组合",width:300,titlePrefix:{content:"流向中的SKU和Q匹配产品组合"}},{field:"entity",title:"Entity",width:150},{field:"productCode",title:"产品编码",width:150,titlePrefix:{content:"流向中的SKU关联的产品"}},{field:"productName",title:"产品名称",width:300},{field:"achieveAmount",title:"项目达成金额",width:150,titlePrefix:{content:"流向中分部+by产品组合+产品的SUM(SKU销量*考核价)"}}]}));return(e,i)=>{const d=f("vxe-grid");return p(),m(d,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{toolbar_buttons:y((()=>[])),operations:y((()=>[])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/ResultByBranch.vue"]]),te=h(s({__name:"ResultByPayObjectTotal",props:{data:{type:null,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,columns:[{field:"quarter",title:"季度",width:150},{field:"entity",title:"Entity",width:150},{field:"paymentDealerCode",title:"支付商业编码",width:150},{field:"paymentDealerName",title:"支付商业名称",width:150},{field:"actuallyAmount",title:"实际支付金额（无税）",titlePrefix:{content:"如果实际支付金额大于0，存入此列"},width:220,formatter:({cellValue:e})=>g(e>0?e:0)},{field:"actuallyAmount",title:"待回收返利金额（无税）",titlePrefix:{content:"如果实际支付金额小于0，取绝对值，存入此列"},width:220,formatter:({cellValue:e})=>g(e<0?-1*e:0)}]}));return(e,i)=>{const d=f("vxe-grid");return p(),m(d,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{toolbar_buttons:y((()=>[])),operations:y((()=>[])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/ResultByPayObjectTotal.vue"]]),ae=h(s({__name:"ResultByPayObject",props:{data:{type:null,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,columns:[{field:"quarter",title:"季度",width:150},{field:"entity",title:"Entity",width:150},{field:"paymentDealerCode",title:"支付商业编码",width:150},{field:"paymentDealerName",title:"支付商业名称",width:150},{field:"productName",title:"产品名称",width:150},{field:"actuallyAmount",title:"实际支付金额（无税）",titlePrefix:{content:"如果实际支付金额大于0，存入此列"},width:220,formatter:({cellValue:e})=>g(e>0?e:0)},{field:"actuallyAmount",title:"待回收返利金额（无税）",titlePrefix:{content:"如果实际支付金额小于0，取绝对值，存入此列"},width:220,formatter:({cellValue:e})=>g(e<0?-1*e:0)}]}));return(e,i)=>{const d=f("vxe-grid");return p(),m(d,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{toolbar_buttons:y((()=>[])),operations:y((()=>[])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/ResultByPayObject.vue"]]),le=h(s({__name:"ResultByPayObjectLevelOne",props:{data:{type:null,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,columns:[{field:"quarter",title:"季度",width:150},{field:"paymentDealerCode",title:"支付商业编码",width:150},{field:"paymentDealerName",title:"支付商业名称",width:150},{field:"paymentDealerCodeLevelOne",title:"一级转支付商业编码",width:200},{field:"paymentDealerNameLevelOne",title:"一级转支付商业名称",width:200},{field:"entity",title:"Entity",width:150},{field:"productCode",title:"产品编码",width:150},{field:"productName",title:"产品名称",width:150},{field:"actuallyAmount",title:"实际支付金额（无税）",titlePrefix:{content:"如果实际支付金额大于0，存入此列"},width:220,formatter:({cellValue:e})=>g(e>0?e:0)},{field:"actuallyAmount",title:"待回收返利金额（无税）",titlePrefix:{content:"如果实际支付金额小于0，取绝对值，存入此列"},width:220,formatter:({cellValue:e})=>g(e<0?-1*e:0)}]}));return(e,i)=>{const d=f("vxe-grid");return p(),m(d,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{toolbar_buttons:y((()=>[])),operations:y((()=>[])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/ResultByPayObjectLevelOne.vue"]]),ie=h(s({__name:"ResultByPayObjectLevelTwo",props:{data:{type:null,required:!0}},setup(e){const t=e,a=c(),l=w(o(n({},M("grid")),{pagerConfig:void 0,columns:[{field:"quarter",title:"季度",width:150},{field:"paymentDealerCode",title:"支付商业编码",width:150},{field:"paymentDealerName",title:"支付商业名称",width:150},{field:"paymentDealerCodeLevelOne",title:"一级转支付商业编码",width:200},{field:"paymentDealerNameLevelOne",title:"一级转支付商业名称",width:200},{field:"paymentDealerCodeLevelTwo",title:"二级转支付商业编码",width:200},{field:"paymentDealerNameLevelTwo",title:"二级转支付商业名称",width:200},{field:"entity",title:"Entity",width:150},{field:"productCode",title:"产品编码",width:150},{field:"productName",title:"产品名称",width:150},{field:"actuallyAmount",title:"实际支付金额（无税）",titlePrefix:{content:"如果实际支付金额大于0，存入此列"},width:220,formatter:({cellValue:e})=>g(e>0?e:0)},{field:"actuallyAmount",title:"待回收返利金额（无税）",titlePrefix:{content:"如果实际支付金额小于0，取绝对值，存入此列"},width:220,formatter:({cellValue:e})=>g(e<0?-1*e:0)}]}));return(e,i)=>{const d=f("vxe-grid");return p(),m(d,_({ref_key:"xGrid",ref:a},x(l),{data:t.data}),{toolbar_buttons:y((()=>[])),operations:y((()=>[])),_:1},16,["data"])}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/components/ResultByPayObjectLevelTwo.vue"]]),de={style:{"margin-bottom":"10px"}},re={key:0,style:{color:"red","margin-top":"20px"}},ne={key:2,style:{color:"red","margin-top":"20px"}},oe=h(s({__name:"RebatePaymentCreatorView",setup(e){const t=k(),a=C(),l=c("4"),i=c(["main","plans","deduct","results"]),d=K(t,"payment-retail-rebate-create")||K(t,"payment-retail-rebate-edit"),r=K(t,"payment-retail-rebate-appealing"),n=K(t,"payment-retail-rebate-checking"),o=K(t,"payment-retail-rebate-checked"),s=t.params.id instanceof Array?t.params.id[0]:t.params.id,h=w({mainData:{},planData:[],deductReportData:[],headquarterResultData:[],branchResultData:[],payObjectResultData:[],remark:""});function _(){G("成功发布初版，发邮件给零售KA团队，提醒在窗口期内完成数据的申诉").then((()=>{s?O(a,"payment-retail-rebate-appealing",{id:s}):G("数据不完整")}))}function P(){G("校验是否所有的数据都标记完成。成功发布终版后，数据冻结。发送提醒邮件给KA团队。报告名称+终版发布通知。\n    过滤掉不支付的数据（生成分部的时候，要剔除掉不支付的总部关联的分部），生成其他汇总tab。").then((()=>{O(a,"payment-retail-rebate-checked",{id:s})}))}return A((()=>{return e=this,t=null,a=function*(){if(s){const e=yield B(s);h.mainData=e.data,h.planData=e.data.rebatePlans,h.deductReportData=e.data.deductReports,h.headquarterResultData=e.data.headquarterResults,h.branchResultData=e.data.branchResults,h.payObjectResultData=e.data.payObjectResults}else h.mainData={type:"",year:"",name:"",customerCategory:[],customerLevelType:"",productMix:[],startQuarter:"",endQuarter:"",paymentRatio:"",automaticDeduction:"",windowPeriodStart:"",windowPeriodEnd:""}},new Promise(((l,i)=>{var d=e=>{try{n(a.next(e))}catch(t){i(t)}},r=e=>{try{n(a.throw(e))}catch(t){i(t)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(d,r);n((a=a.apply(e,t)).next())}));var e,t,a})),(e,t)=>{const s=I,c=f("vxe-button"),w=j,g=q,V=X,k=u,C=f("vxe-form-item"),A=f("vxe-form"),K=f("page-container");return p(),m(K,null,{default:y((()=>[b(V,{activeKey:x(i),"onUpdate:activeKey":t[7]||(t[7]=e=>R(i)?i.value=e:null)},{default:y((()=>[b(s,{key:"main",header:"结算报告主体信息"},{default:y((()=>[b($,{data:x(h).mainData,editable:x(d)},null,8,["data","editable"])])),_:1}),v(' <a-collapse-panel key="plans" header="返利方案">\n        <PlanList :data="pageData.planData" :editable="isDraft" :can-cal="isDraft || isChecking" />\n      </a-collapse-panel> '),b(s,{key:"deduct",header:"扣减报告"},{default:y((()=>[b(J,{data:x(h).deductReportData,editable:x(d)},null,8,["data","editable"])])),_:1}),b(s,{key:"results",header:"结算结果"},{default:y((()=>[D("div",de,[x(d)?(p(),m(c,{key:0,status:"primary",content:"计算",onClick:t[0]||(t[0]=e=>x(G)("计算分为三种情况：\n            1. 当没有上传任何数据时，系统自动按逻辑获取流向，汇总数据，匹配方案，计算返利金额，计算扣减，匹配回收等；\n            2. 当上传了流向明细时，系统按上传的流向明细汇总数据，匹配方案，计算返利金额，计算扣减，匹配回收等；\n            3. 当上传了流向明细&汇总时，系统按照上传的汇总数据计算扣减，匹配回收等；"))})):v("v-if",!0),x(d)?(p(),m(c,{key:1,status:"primary",content:"上传流向明细",onClick:t[1]||(t[1]=e=>x(G)("清除系统自动框定的流向，以导入的流向为基础数据做计算。导入时不做逻辑校验，信任导入的数据"))})):v("v-if",!0),x(d)?(p(),m(c,{key:2,status:"primary",content:"上传流向明细&汇总",onClick:t[2]||(t[2]=e=>x(G)("清除系统自动框定的流向和计算的汇总数据，以导入的汇总信息做计算，导入的流向作为关联数据存档。导入时不做逻辑校验，信任导入的数据"))})):v("v-if",!0),x(d)?(p(),m(c,{key:3,status:"primary",content:"清除结果",onClick:t[3]||(t[3]=e=>x(G)("清除上传数据和计算结果"))})):v("v-if",!0),b(c,{content:"下载结算结果",onClick:t[4]||(t[4]=e=>x(G)("下载包括流向明细，注意KA的数据权限"))}),b(c,{status:"danger",content:"权限筛选规则",onClick:t[5]||(t[5]=e=>x(G)("此按钮仅为说明业务。\n                岗位KA属性===客户KA属性，基于岗位-客户关系即零售KA辖区客户，来筛选总部数据。\n                如果两个KA对应到了一个总部，则有相同的总部权限！\n                在查看分部的时候，查看自己关联的分部。其他汇总都一样。"))})]),b(g,{activeKey:x(l),"onUpdate:activeKey":t[6]||(t[6]=e=>R(l)?l.value=e:null),type:"card"},{default:y((()=>[x(o)?(p(),m(w,{key:"1",tab:"汇总至支付商业Total"},{default:y((()=>[b(te,{data:x(h).payObjectResultData},null,8,["data"])])),_:1})):v("v-if",!0),x(o)?(p(),m(w,{key:"2",tab:"汇总至支付商业"},{default:y((()=>[b(ae,{data:x(h).payObjectResultData},null,8,["data"])])),_:1})):v("v-if",!0),x(o)?(p(),m(w,{key:"8",tab:"汇总至一级转支付商业"},{default:y((()=>[b(le,{data:x(h).payObjectResultData},null,8,["data"])])),_:1})):v("v-if",!0),x(o)?(p(),m(w,{key:"9",tab:"汇总至二级转支付商业"},{default:y((()=>[b(ie,{data:x(h).payObjectResultData},null,8,["data"])])),_:1})):v("v-if",!0),b(w,{key:"4",tab:"汇总至总部"},{default:y((()=>[b(Z,{data:x(h).headquarterResultData,"is-appealing":x(r),"is-checking":x(n),"is-draft":x(d)},null,8,["data","is-appealing","is-checking","is-draft"])])),_:1}),x(o)?(p(),m(w,{key:"5",tab:"汇总至分部"},{default:y((()=>[b(ee,{data:x(h).branchResultData},null,8,["data"])])),_:1})):v("v-if",!0)])),_:1},8,["activeKey"])])),_:1})])),_:1},8,["activeKey"]),x(o)?(p(),U("div",re," 审批通过的返利结算报告，零售KA团队需要上传支付凭证（pdf，图片等格式），按结算报告上传。 ")):v("v-if",!0),x(o)?(p(),m(k,{key:1,"enable-insert":!0,"enable-remove":!0})):v("v-if",!0),x(o)?(p(),U("div",ne," 附件和结算概要，在提交审批前上传和填写，对于零售KA团队和Leader不可见！ ")):v("v-if",!0),x(o)?(p(),m(k,{key:3,"enable-insert":!0,"enable-remove":!0})):v("v-if",!0),b(A,{data:x(h)},{default:y((()=>[x(o)?(p(),m(C,{key:0,field:"remark",title:"结算概要",span:24,"item-render":{}},{default:y((({data:e})=>[b(x(z),{content:e.remark},null,8,["content"])])),_:1})):v("v-if",!0),b(C,{align:"center","title-align":"left",span:24},{default:y((()=>[x(d)?(p(),m(c,{key:0,type:"submit",status:"primary",content:"发布初版",onClick:_})):v("v-if",!0),x(n)?(p(),m(c,{key:1,type:"submit",status:"primary",content:"发布终版",onClick:P})):v("v-if",!0),x(o)?(p(),m(c,{key:2,status:"primary",content:"提交",onClick:t[8]||(t[8]=e=>x(G)("提交审批，开启审批流"))})):v("v-if",!0),x(d)?(p(),m(c,{key:3,type:"submit",status:"primary",content:"保存草稿"})):v("v-if",!0),b(c,{onClick:t[9]||(t[9]=e=>x(O)(x(a),"payment-retail-rebate")),content:"回到列表"})])),_:1})])),_:1},8,["data"])])),_:1})}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/retail-rebate-payment/RebatePaymentCreatorView.vue"]]);export{oe as default};

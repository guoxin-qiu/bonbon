var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(t,l,i)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[l]=i,o=(e,t)=>{for(var l in t||(t={}))a.call(t,l)&&d(e,l,t[l]);if(i)for(var l of i(t))n.call(t,l)&&d(e,l,t[l]);return e},r=(e,i)=>t(e,l(i));import{_ as s}from"./index.9b869bd5.js";import{d as p,bn as f,aQ as u,r as c,az as m,bj as h,aV as y,aW as w,aS as v,a as b,aX as _,aR as k,ca as g,ay as C,ac as V,a_ as R,bR as S,cj as x,ck as I,cf as P,bk as N,cl as $,bK as D,a$ as U}from"./index.44eff430.js";import{g as j,a as O,b as T}from"./vxeTableHelper.6baae079.js";import{l as F,g as K,s as G,m as z,b as Y,q as Q}from"./temporary-data.4dfd9cc4.js";import{d as A}from"./dayjs.min.7438ea6f.js";import{c as M,r as B}from"./routerHelper.692f5c09.js";import{a as H}from"./c-plan-inventory.service.aeccc628.js";import{_ as E,C as q}from"./CollapsePanel.5cf4e0c3.js";const L=U(p({__name:"FactoryPriceReduceCalculate",setup(e){const t=f(),l=u(),i=c(),a=M(t,"c-payment-inventory-fac-calculate"),n=M(t,"c-payment-inventory-fac-check-calculate"),d=M(t,"c-payment-inventory-fac-ready-for-finance"),p=M(t,"c-payment-inventory-fac-confirm-calculate"),U=M(t,"c-payment-inventory-fac-confirmed"),L=A().format("YYYY-MM-DD"),W=A().add(13,"day").format("YYYY-MM-DD"),X=c("1"),J=c("1"),Z=c([]),ee=m({formData:{chineseName:"单出厂价下调库存结算报告",englishName:"Single factory price downward inventory settlement report",inventoryCompensationScenario:"单出厂价下调",inventoryCompensationType:"库存补偿",t1t2Ref:"2022Q4",windowPhaseStartDate:L,windowPhaseEndDate:W},showInventorySelector:!1,showInventoryCreator:!1,showInventoryCheck:!1,showT1Selector:!1,showInventoryCertSelector:!1,showFinanceSelector:!1,showAppealSelector:!1}),te=m({status:"",reason:""}),le=m(r(o({},j("importerDetailGrid",(e=>H(r(o({},e),{planId:2,type:"进口商"}))))),{columns:[{field:"type",title:"补偿对象",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"basePriceOld",title:"旧CIF价",width:120},{field:"basePriceNew",title:"新CIF价",width:120},{field:"unitPrice",title:"补偿单价",width:100},{field:"inventoryDate",title:"盘库日期",width:100},{field:"priceReductionDate",title:"降价日期",width:100}]})),ie=m(r(o({},j("dealerDetailGrid",(e=>H(r(o({},e),{planId:2,type:"渠道"}))))),{columns:[{field:"type",title:"补偿对象",width:100},{field:"province",title:"省份",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"basePriceOld",title:"旧一级商底价",width:120},{field:"basePriceNew",title:"新一级商底价",width:120},{field:"unitPrice",title:"补偿单价",width:100},{field:"inventoryDate",title:"盘库日期",width:100},{field:"priceReductionDate",title:"降价日期",width:100}]})),ae=m(r(o({},j("sumByDealerGrid")),{data:F.filter((e=>"渠道"===e.cObject)),pagerConfig:void 0,showHeaderOverflow:!0,formConfig:{items:[{field:"sku",span:4,itemRender:{name:"$select",options:[],props:{placeholder:"产品编码或名称"}}},{field:"buyerProvince",span:4,itemRender:{name:"$select",options:[],props:{placeholder:"省份"}}},{field:"t1",span:4,itemRender:{name:"$select",options:[],props:{placeholder:"一级商业"}}},{span:8,align:"center",itemRender:{name:"$buttons",children:[{props:{type:"submit",content:"搜索",status:"primary"}},{props:{type:"reset",content:"清空"}}]}}]},columns:[{field:"paymentObject",title:"支付对象",width:100},{field:"t1",title:"一级商业",width:200},{field:"dealerCode",title:"客户编码",width:100},{field:"dealerName",title:"客户名称",width:200},{field:"province",title:"省份",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"InventoryQuantity",title:"库存数量",width:100},{field:"unitPrice",title:"补偿单价",width:100},{field:"amount",title:"补偿金额",width:100}]})),ne=m(r(o({},j("sumByImporterGrid")),{data:F.filter((e=>"进口商"===e.cObject)),pagerConfig:void 0,showHeaderOverflow:!0,formConfig:{items:[{field:"sku",span:4,itemRender:{name:"$select",options:[],props:{placeholder:"产品编码或名称"}}},{field:"t1",span:4,itemRender:{name:"$select",options:[],props:{placeholder:"一级商业"}}},{span:8,align:"center",itemRender:{name:"$buttons",children:[{props:{type:"submit",content:"搜索",status:"primary"}},{props:{type:"reset",content:"清空"}}]}}]},columns:[{field:"paymentObject",title:"支付对象",width:100},{field:"t1",title:"一级商业",width:200},{field:"dealerCode",title:"客户编码",width:100},{field:"dealerName",title:"客户名称",width:200},{field:"province",title:"省份",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"InventoryQuantity",title:"库存数量",width:100},{field:"unitPrice",title:"补偿单价",width:100},{field:"amount",title:"补偿金额",width:100}]})),de=m(r(o({},j("inventoryDealerGrid")),{data:F.filter((e=>"渠道"===e.cObject)),pagerConfig:void 0,formConfig:{items:[{itemRender:{name:"$select",options:K.filter((e=>0===e.parentId)).map((e=>({value:e.id,label:e.name}))),props:{placeholder:"省份"}}},{itemRender:{name:"$select",options:G.map((e=>({value:e.code,label:e.name}))),props:{filterable:!0,placeholder:"产品编码或名称"}}},{itemRender:{name:"$select",options:[],props:{filterable:!0,placeholder:"库存商业编码或名称"}}},{folding:!0,itemRender:{name:"$input",props:{type:"date",placeholder:"库存日期从"}}},{folding:!0,itemRender:{name:"$input",props:{type:"date",placeholder:"库存日期到"}}},{folding:!0,itemRender:{name:"$select",options:z,props:{placeholder:"库存状态"}}},{folding:!0,itemRender:{name:"$input",props:{placeholder:"批号"}}},{collapseNode:!0,itemRender:{},slots:{default:"search_operation"}}]},columns:[{field:"checkbox",type:"checkbox",width:50,align:"center",fixed:"left"},{field:"inventoryDate",title:"库存日期",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"province",title:"省份",width:80},{field:"dealerCode",title:"库存商业编码",width:120},{field:"dealerName",title:"库存商业名称",width:200},{field:"InventoryQuantity",title:"库存数量",width:100},{field:"InventoryStatus",title:"库存状态",width:100},{field:"LotNo",title:"批号",width:100},{field:"inventoryDate",title:"盘库日期",width:100},{field:"priceReductionDate",title:"降价日期",width:100},{field:"basePriceNew",title:"新一级商底价",width:110},{field:"basePriceOld",title:"旧一级商底价",width:110},{field:"unitPrice",title:"补偿单价",width:100},{field:"amount",title:"补偿金额",width:100},{field:"t1",title:"一级商业",width:200},{field:"remark",title:"商务备注",width:200},{field:"isMarked",title:"标记完成",width:100},{field:"approvalStatus",title:"核验状态",width:100},{field:"approvalRemark",title:"核验意见",width:200},{field:"appealRemark",title:"申诉原因",width:200},{title:"操作",align:"left",width:180,fixed:n||a?"right":void 0,slots:{default:"operations"}}]})),oe=m(r(o({},j("inventoryImporterGrid")),{data:F.filter((e=>"进口商"===e.cObject)),pagerConfig:void 0,formConfig:{items:[{itemRender:{name:"$select",options:G.map((e=>({value:e.code,label:e.name}))),props:{filterable:!0,placeholder:"产品编码或名称"}}},{itemRender:{name:"$select",options:[],props:{filterable:!0,placeholder:"库存商业编码或名称"}}},{folding:!0,itemRender:{name:"$input",props:{type:"date",placeholder:"库存日期从"}}},{folding:!0,itemRender:{name:"$input",props:{type:"date",placeholder:"库存日期到"}}},{folding:!0,itemRender:{name:"$select",options:z,props:{placeholder:"库存状态"}}},{folding:!0,itemRender:{name:"$input",props:{placeholder:"批号"}}},{collapseNode:!0,itemRender:{},slots:{default:"search_operation"}}]},columns:[{field:"checkbox",type:"checkbox",width:50,align:"center",fixed:"left"},{field:"inventoryDate",title:"库存日期",width:100},{field:"source",title:"数据来源",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"dealerCode",title:"库存商业编码",width:120},{field:"dealerName",title:"库存商业名称",width:200},{field:"InventoryQuantity",title:"库存数量",width:100},{field:"InventoryStatus",title:"库存状态",width:100},{field:"LotNo",title:"批号",width:100},{field:"inventoryDate",title:"盘库日期",width:100},{field:"priceReductionDate",title:"降价日期",width:100},{field:"basePriceNew",title:"CIF价格",width:110},{field:"basePriceOld",title:"CIF价格",width:110},{field:"unitPrice",title:"补偿单价",width:100},{field:"amount",title:"补偿金额",width:100},{field:"t1",title:"一级商业",width:200},{field:"remark",title:"商务备注",width:200},{field:"isMarked",title:"标记完成",width:100},{field:"approvalStatus",title:"核验状态",width:100},{field:"approvalRemark",title:"核验意见",width:200},{field:"appealRemark",title:"申诉原因",width:200},{title:"操作",align:"left",width:180,fixed:n||a?"right":void 0,slots:{default:"operations"}}]})),re=m(r(o({},j("inventorySelectorGrid")),{data:F,rowConfig:{isHover:!1},formConfig:{items:[{itemRender:{name:"$select",options:K.filter((e=>0===e.parentId)).map((e=>({value:e.id,label:e.name}))),props:{placeholder:"省份"}}},{itemRender:{name:"$select",options:G.map((e=>({value:e.code,label:e.name}))),props:{filterable:!0,placeholder:"产品编码或名称"}}},{itemRender:{name:"$select",options:[],props:{filterable:!0,placeholder:"库存商业编码或名称"}}},{folding:!0,itemRender:{name:"$input",props:{type:"date",placeholder:"库存日期从"}}},{folding:!0,itemRender:{name:"$input",props:{type:"date",placeholder:"库存日期到"}}},{folding:!0,itemRender:{name:"$select",options:z,props:{placeholder:"库存状态"}}},{folding:!0,itemRender:{name:"$input",props:{placeholder:"批号"}}},{folding:!0,itemRender:{name:"$select",options:[],props:{placeholder:"是否预筛选"}}},{collapseNode:!0,itemRender:{},slots:{default:"search_operation"}}]},columns:[{field:"checkbox",type:"checkbox",width:50,align:"center",fixed:"left"},{field:"inventoryDate",title:"库存日期",width:100},{field:"skuCode",title:"产品编码",width:100},{field:"skuName",title:"产品名称",width:200},{field:"province",title:"省份",width:80},{field:"dealerCode",title:"库存商业编码",width:120},{field:"dealerName",title:"库存商业名称",width:200},{field:"InventoryQuantity",title:"库存数量",width:100},{field:"InventoryStatus",title:"库存状态",width:100},{field:"LotNo",title:"批号",width:100},{field:"isPre",title:"是否预筛选",width:100}]})),se=({row:e})=>{if("是"===e.isPre)return"row-green"};return(e,t)=>{const o=h("vxe-option"),r=h("vxe-select"),f=h("vxe-form-item"),u=h("vxe-input"),c=h("vxe-form"),m=h("vxe-grid"),j=$,F=D,K=E,G=q,z=h("vxe-button"),A=h("vxe-modal"),M=h("vxe-textarea"),H=s,L=h("page-container");return y(),w(L,null,{default:v((()=>[b(c,{"title-align":"right","title-width":"100",data:C(ee).formData,ref_key:"xForm",ref:i},{default:v((()=>[_(' <vxe-form-item\n        title-width="180"\n        field="inventoryCompensationType"\n        title="报告类型"\n        :span="12"\n        :item-render="{}"\n      >\n        <template #default="{ data }">\n          <vxe-select v-model="data.inventoryCompensationType" disabled placeholder="">\n            <vxe-option\n              v-for="item in compensationType"\n              :key="item.value"\n              :value="item.value"\n              :label="item.label"\n            ></vxe-option>\n          </vxe-select>\n        </template>\n      </vxe-form-item> '),b(f,{"title-width":"180",field:"inventoryCompensationScenario",title:"降价类型",span:12,"item-render":{}},{default:v((({data:e})=>[b(r,{modelValue:e.inventoryCompensationScenario,"onUpdate:modelValue":t=>e.inventoryCompensationScenario=t,transfer:"",disabled:"",placeholder:""},{default:v((()=>[(y(!0),k(V,null,g(C(Y),(e=>(y(),w(o,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),b(f,{"title-width":"180",field:"chineseName",title:"报告名称（中文）",span:24,"item-render":{}},{default:v((({data:e})=>[b(u,{modelValue:e.chineseName,"onUpdate:modelValue":t=>e.chineseName=t,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),b(f,{"title-width":"180",field:"englishName",title:"报告名称（英文）",span:24,"item-render":{}},{default:v((({data:e})=>[b(u,{modelValue:e.englishName,"onUpdate:modelValue":t=>e.englishName=t,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),b(f,{"title-width":"180",field:"t1t2Ref",title:"T1&T2关系",span:8,"item-render":{}},{default:v((({data:e})=>[b(r,{modelValue:e.t1t2Ref,"onUpdate:modelValue":t=>e.t1t2Ref=t,transfer:"",disabled:"",clearable:"",placeholder:""},{default:v((()=>[(y(!0),k(V,null,g(C(Q),(e=>(y(),w(o,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),b(f,{"title-width":"180",field:"windowPhase",title:"窗口期",span:16,"item-render":{}},{default:v((({data:e})=>[b(u,{modelValue:e.windowPhaseStartDate,"onUpdate:modelValue":t=>e.windowPhaseStartDate=t,disabled:"",type:"datetime",style:{width:"180px"}},null,8,["modelValue","onUpdate:modelValue"]),R(" 至 "),b(u,{modelValue:e.windowPhaseEndDate,"onUpdate:modelValue":t=>e.windowPhaseEndDate=t,disabled:"",type:"datetime",style:{width:"180px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"]),b(G,{activeKey:C(Z),"onUpdate:activeKey":t[1]||(t[1]=e=>S(Z)?Z.value=e:null),accordion:""},{default:v((()=>[b(K,{key:"1",header:"补偿方案信息 展开/收起"},{default:v((()=>[b(F,{activeKey:C(J),"onUpdate:activeKey":t[0]||(t[0]=e=>S(J)?J.value=e:null),type:"card",style:{"margin-top":"10px"}},{default:v((()=>[b(j,{key:"2",tab:"进口商"},{default:v((()=>[b(m,x(I(C(le))),null,16)])),_:1}),b(j,{key:"1",tab:"渠道"},{default:v((()=>[b(m,x(I(C(ie))),null,16)])),_:1})])),_:1},8,["activeKey"])])),_:1})])),_:1},8,["activeKey"]),b(c,{"title-align":"right","title-width":"100",style:{"margin-top":"10px"}},{default:v((()=>[b(f,{title:"补偿详情","title-align":"left","title-width":160,span:24,"title-prefix":{icon:"vxe-icon-comment"}},{default:v((()=>[C(n)||C(a)?_("v-if",!0):(y(),w(z,{key:0,onClick:t[2]||(t[2]=e=>C(O)("商务经理和商务总监根据各自省份权限查看和下载汇总数据"))},{default:v((()=>[R(" 下载汇总数据 ")])),_:1})),C(d)||C(U)?(y(),w(z,{key:1,onClick:t[3]||(t[3]=e=>C(O)("商务和商务总监不可见").then((()=>{C(ee).showFinanceSelector=!0})))},{default:v((()=>[R(" 财务审核凭证 ")])),_:1})):_("v-if",!0)])),_:1})])),_:1}),b(F,{activeKey:C(X),"onUpdate:activeKey":t[28]||(t[28]=e=>S(X)?X.value=e:null),type:"card",style:{"margin-top":"20px"}},{default:v((()=>[C(a)||C(n)?_("v-if",!0):(y(),w(j,{key:"4",tab:"补偿汇总-进口商"},{default:v((()=>[b(m,P({ref:"sumByT1Grid"},C(ne)),{toolbar_buttons:v((()=>[C(n)||C(a)?_("v-if",!0):(y(),w(z,{key:0,onClick:t[4]||(t[4]=e=>C(O)("商务经理和商务总监根据各自省份权限查看和下载汇总数据。其他角色下载所有。"))},{default:v((()=>[R(" 下载数据 ")])),_:1}))])),_:1},16)])),_:1})),C(a)||C(n)?_("v-if",!0):(y(),w(j,{key:"3",tab:"补偿汇总-渠道"},{default:v((()=>[b(m,P({ref:"sumByT1Grid"},C(ae)),{toolbar_buttons:v((()=>[C(n)||C(a)?_("v-if",!0):(y(),w(z,{key:0,onClick:t[5]||(t[5]=e=>C(O)("商务经理和商务总监根据各自省份权限查看和下载汇总数据。其他角色下载所有。"))},{default:v((()=>[R(" 下载数据 ")])),_:1}))])),_:1},16)])),_:1})),b(j,{key:"2",tab:"进口商库存补偿明细"},{default:v((()=>[b(m,x(I(C(oe))),{toolbar_buttons:v((()=>[C(a)?(y(),w(z,{key:0,status:"primary",onClick:t[6]||(t[6]=e=>C(ee).showInventorySelector=!0)},{default:v((()=>[R(" 选择添加库存 ")])),_:1})):_("v-if",!0),C(a)?(y(),w(z,{key:1,status:"primary",onClick:t[7]||(t[7]=e=>C(ee).showT1Selector=!0)},{default:v((()=>[R(" 更新一级商 ")])),_:1})):_("v-if",!0),C(a)||C(n)?(y(),w(z,{key:2,status:"primary",onClick:t[8]||(t[8]=e=>C(O)("数据团队可以手工添加接口中不存在的库存，系统要留痕。").then((()=>C(ee).showInventoryCreator=!0)))},{default:v((()=>[R(" 手工添加库存 ")])),_:1})):_("v-if",!0),b(z,null,{default:v((()=>[R("下载数据")])),_:1}),C(n)||C(a)?(y(),w(z,{key:3,status:"primary",onClick:t[9]||(t[9]=e=>C(O)("系统仅计算总金额，不保存到数据库\n              根据角色可见数据范围进行sum"))},{default:v((()=>[R(" 试算 ")])),_:1})):_("v-if",!0),C(n)?(y(),w(z,{key:4,status:"warning",onClick:t[10]||(t[10]=e=>C(ee).showInventoryCheck=!0)},{default:v((()=>[R(" 数据核验 ")])),_:1})):_("v-if",!0),C(n)?(y(),w(z,{key:5,status:"warning",onClick:t[11]||(t[11]=e=>C(O)("仅数据团队操作。\n            可以将库存数据标记为完成状态。\n            只能对核验通过或核验拒绝的数据进行操作。\n            如果标记为完成，则即使是核验拒绝状态，商务也不能调整。"))},{default:v((()=>[R(" 标记完成 ")])),_:1})):_("v-if",!0),C(a)?(y(),w(z,{key:6,status:"primary",onClick:t[12]||(t[12]=e=>C(O)("提交可以根据勾选情况或查询条件来做批量提交\n                  如果一级商为空，则需要给出提交失败提示"))},{default:v((()=>[R(" 提交 ")])),_:1})):_("v-if",!0),b(z,{status:"primary",onClick:t[13]||(t[13]=e=>C(ee).showInventoryCertSelector=!0)},{default:v((()=>[R(" 库存凭证 ")])),_:1})])),search_operation:v((()=>[b(z,{status:"primary",onClick:t[14]||(t[14]=e=>C(O)("商务经理按省份查看，进口商务按进口商务-进口商关系查看"))},{default:v((()=>[R(" 搜索 ")])),_:1})])),operations:v((()=>[C(n)||C(a)?(y(),w(z,{key:0,status:"danger",onClick:t[15]||(t[15]=e=>C(O)("按数据可见范围显示；包括商务分省、进口商务分产品、数据团队手工创建数据；直接删除"))},{default:v((()=>[R(" 删除 ")])),_:1})):_("v-if",!0),C(a)?(y(),w(z,{key:1,status:"primary",onClick:t[16]||(t[16]=e=>C(O)("只有商务才使用此按钮\n              只有核验拒绝且未标记为完成的数据，才能使用申诉功能").then((()=>C(ee).showAppealSelector=!0)))},{default:v((()=>[R(" 申诉 ")])),_:1})):_("v-if",!0)])),_:1},16)])),_:1}),b(j,{key:"1",tab:"渠道库存补偿明细"},{default:v((()=>[b(m,x(I(C(de))),{toolbar_buttons:v((()=>[C(a)?(y(),w(z,{key:0,status:"primary",onClick:t[17]||(t[17]=e=>C(ee).showInventorySelector=!0)},{default:v((()=>[R(" 选择添加库存 ")])),_:1})):_("v-if",!0),C(a)?(y(),w(z,{key:1,status:"primary",onClick:t[18]||(t[18]=e=>C(ee).showT1Selector=!0)},{default:v((()=>[R(" 更新一级商 ")])),_:1})):_("v-if",!0),C(a)||C(n)?(y(),w(z,{key:2,status:"primary",onClick:t[19]||(t[19]=e=>C(O)("数据团队可以手工添加接口中不存在的库存，系统要留痕。").then((()=>C(ee).showInventoryCreator=!0)))},{default:v((()=>[R(" 手工添加库存 ")])),_:1})):_("v-if",!0),b(z,null,{default:v((()=>[R("下载数据")])),_:1}),C(n)||C(a)?(y(),w(z,{key:3,status:"primary",onClick:t[20]||(t[20]=e=>C(O)("系统仅计算总金额，不保存到数据库\n              根据角色可见数据范围进行sum"))},{default:v((()=>[R(" 试算 ")])),_:1})):_("v-if",!0),C(n)?(y(),w(z,{key:4,status:"warning",onClick:t[21]||(t[21]=e=>C(ee).showInventoryCheck=!0)},{default:v((()=>[R(" 数据核验 ")])),_:1})):_("v-if",!0),C(n)?(y(),w(z,{key:5,status:"warning",onClick:t[22]||(t[22]=e=>C(O)("仅数据团队操作。\n            可以将库存数据标记为完成状态。\n            只能对核验通过或核验拒绝的数据进行操作。\n            如果标记为完成，则即使是核验拒绝状态，商务也不能调整。"))},{default:v((()=>[R(" 标记完成 ")])),_:1})):_("v-if",!0),C(a)?(y(),w(z,{key:6,status:"primary",onClick:t[23]||(t[23]=e=>C(O)("提交可以根据勾选情况或查询条件来做批量提交\n                  如果一级商为空，则需要给出提交失败提示"))},{default:v((()=>[R(" 提交 ")])),_:1})):_("v-if",!0),b(z,{status:"primary",onClick:t[24]||(t[24]=e=>C(ee).showInventoryCertSelector=!0)},{default:v((()=>[R(" 库存凭证 ")])),_:1})])),search_operation:v((()=>[b(z,{status:"primary",onClick:t[25]||(t[25]=e=>C(O)("商务经理按省份查看，进口商务按进口商务-进口商关系查看"))},{default:v((()=>[R(" 搜索 ")])),_:1})])),operations:v((()=>[C(n)||C(a)?(y(),w(z,{key:0,status:"danger",onClick:t[26]||(t[26]=e=>C(O)("按数据可见范围显示；包括商务分省、进口商务分产品、数据团队手工创建数据；直接删除"))},{default:v((()=>[R(" 删除 ")])),_:1})):_("v-if",!0),C(a)?(y(),w(z,{key:1,status:"primary",onClick:t[27]||(t[27]=e=>C(O)("只有商务才使用此按钮\n              只有核验拒绝且未标记为完成的数据，才能使用申诉功能").then((()=>C(ee).showAppealSelector=!0)))},{default:v((()=>[R(" 申诉 ")])),_:1})):_("v-if",!0)])),_:1},16)])),_:1})])),_:1},8,["activeKey"]),b(c,{"title-align":"right","title-width":"100"},{default:v((()=>[b(f,{align:"center","title-align":"left",span:24},{default:v((()=>[C(n)?(y(),w(z,{key:0,status:"primary",onClick:t[29]||(t[29]=e=>C(O)("如果当前数据有未标记完成的状态，发送提醒邮件给数据负责人。\n            内容：多少条库存数据核验通过，多少条数据核验未通过。带窗口期。邮件名称：报告名称+审核结果通知"))},{default:v((()=>[R(" 发送邮件提醒 ")])),_:1})):_("v-if",!0),C(n)?(y(),w(z,{key:1,status:"primary",onClick:t[30]||(t[30]=e=>C(O)("系统校验所有数据状态为标记完成。\n              汇总到一级商，by一级商+补偿对象，状态为核验通过的数据。").then((()=>C(B)(C(l),"c-payment-inventory-fac-ready-for-finance"))))},{default:v((()=>[R(" 正式计算 ")])),_:1})):_("v-if",!0),C(p)?(y(),w(z,{key:2,status:"primary",onClick:t[31]||(t[31]=e=>C(O)("商务总监对数据进行核验").then((()=>C(B)(C(l),"c-payment-inventory-fac-confirmed"))))},{default:v((()=>[R(" 数据确认 ")])),_:1})):_("v-if",!0),C(d)?(y(),w(z,{key:3,status:"primary",onClick:t[32]||(t[32]=e=>C(O)("线下完成财务审核，发送提醒邮件给商务总监").then((()=>C(B)(C(l),"c-payment-inventory-fac-confirm-calculate"))))},{default:v((()=>[R(" 发送商务总监确认 ")])),_:1})):_("v-if",!0),C(U)?(y(),w(z,{key:4,status:"primary",onClick:t[33]||(t[33]=e=>C(T)("请检查所有关联附件已上传完成。发布终版后，表单冻结无法修改。").then((e=>{"confirm"===e&&C(O)("当所有的商务总监都确认完成，可以发布终版,表单状态变为待提交审批。\n                发布成功后，会给相关商务经理和商务总监发送“发布终版”通知邮件。\n                ")})))},{default:v((()=>[R(" 发布终版 ")])),_:1})):_("v-if",!0),b(z,{onClick:t[34]||(t[34]=e=>C(B)(C(l),"c-payment-inventory"))},{default:v((()=>[R("返回列表")])),_:1})])),_:1})])),_:1}),b(A,{modelValue:C(ee).showInventorySelector,"onUpdate:modelValue":t[38]||(t[38]=e=>C(ee).showInventorySelector=e),title:"选择冲差库存",width:"80%","min-width":"600","min-height":"300",resize:"","destroy-on-close":""},{default:v((()=>[b(m,P(C(re),{"row-class-name":se,class:"inventory-selector-style"}),{toolbar_buttons:v((()=>[b(z,{status:"primary",onClick:t[35]||(t[35]=e=>C(O)("系统对比选择的数据和补偿方案，如果产品+省份+盘库日期==库存日期不匹配，给出提示，匹配上的正常添加，匹配不上的忽略。"))},{default:v((()=>[R(" 确认添加库存 ")])),_:1})])),search_operation:v((()=>[N("i",{class:"vxe-icon-question-circle-fill",style:{"margin-left":"10px","margin-right":"10px",cursor:"pointer"},onClick:t[36]||(t[36]=e=>C(O)("自动筛选库存数据逻辑：渠道：系统按照方案内容按库存日期，产品，库存商业类型为经销商(不含进口商：数据筛选范围不包含方案选择的进口品对应的进口商库存商业数据 )，零售连锁总店，处方药店，（库存状态为不可销的库存数据不预选）对渠道库存数据进行系统预筛选；进口商：系统按照方案内容按库存日期，产品，库存商业，（库存状态为不可销的库存数据不预选）对进口商库存数据进行系统预筛选，显示在搜索结果中。"))}),b(z,{status:"primary",onClick:t[37]||(t[37]=e=>C(O)("除了系统推荐外，还可以选择其他库存数据么？那这些库存数据是没办法匹配方案的？？？？\n                补偿对象有进口商，需进口商务选择库存；补偿对象有渠道，则需商务经理选择库存。\n        根据角色和补偿方案中的产品编码+省份来确定可选库存的范围。\n        商务经理按省份，进口商务按进口商务-进口商关系"))},{default:v((()=>[R(" 搜索 ")])),_:1})])),_:1},16)])),_:1},8,["modelValue"]),b(A,{modelValue:C(ee).showInventoryCreator,"onUpdate:modelValue":t[41]||(t[41]=e=>C(ee).showInventoryCreator=e),title:"手工添加库存",width:"80%","min-width":"600","min-height":"300",resize:"","destroy-on-close":""},{default:v((()=>[b(c,{"title-align":"right","title-width":"100",onSubmit:t[40]||(t[40]=e=>C(ee).showInventoryCreator=!1)},{default:v((()=>[b(f,{title:"库存日期",span:12,"item-render":{}},{default:v((()=>[b(u,{type:"date",transfer:""})])),_:1}),b(f,{title:"产品",span:12,"item-render":{}},{default:v((()=>[b(r,{transfer:"",placeholder:"输入产品编码或名称查询"})])),_:1}),b(f,{title:"省份",span:12,"item-render":{}},{default:v((()=>[b(r,{transfer:""})])),_:1}),b(f,{title:"库存商业",span:12,"item-render":{},"title-prefix":{content:"只能添加非处方药店的零售单店/零售连锁分店，处方药店按照分月处方结构进行筛选"}},{default:v((()=>[b(r,{transfer:"",placeholder:"输入库存商业编码或名称查询"})])),_:1}),b(f,{title:"库存数量",span:12,"item-render":{}},{default:v((()=>[b(u,{type:"number"})])),_:1}),b(f,{title:"库存状态",span:12,"item-render":{}},{default:v((()=>[b(r,{transfer:""})])),_:1}),b(f,{title:"批号",span:12,"item-render":{}},{default:v((()=>[b(u)])),_:1}),b(f,{align:"center","title-align":"left",span:24},{default:v((()=>[b(z,{type:"submit",status:"primary",onClick:t[39]||(t[39]=e=>C(O)("添加时系统做如下校验：\n                    库存日期+产品+省份+库存商业，不能与商务选择的数据重复。\n                    如果匹配不到库存补偿方案，给出错误提示"))},{default:v((()=>[R(" 确认添加 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),b(A,{modelValue:C(ee).showInventoryCheck,"onUpdate:modelValue":t[45]||(t[45]=e=>C(ee).showInventoryCheck=e),title:"数据核验","min-width":"600","min-height":"300",resize:"","destroy-on-close":""},{default:v((()=>[b(c,{"title-align":"right","title-width":"100",onSubmit:t[44]||(t[44]=e=>C(ee).showInventoryCheck=!1),data:C(te)},{default:v((()=>[b(f,{title:"核验状态",span:24,"title-width":140,"item-render":{}},{default:v((({data:e})=>[b(r,{modelValue:e.status,"onUpdate:modelValue":t=>e.status=t,transfer:"",options:[{value:"核验通过",label:"核验通过"},{value:"核验拒绝",label:"核验拒绝"}]},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),b(f,{title:"拒绝原因快速选择",span:24,"title-width":140,"item-render":{}},{default:v((()=>[b(r,{transfer:"",options:[{value:"库存凭证数量大于库存数量",label:"库存凭证数量大于库存数量"},{value:"库存凭证数量小于库存数量",label:"库存凭证数量小于库存数量"},{value:"一级商业不符合",label:"一级商业不符合"},{value:"补偿范围不符合数据审核",label:"补偿范围不符合数据审核"},{value:"库存凭证缺失",label:"库存凭证缺失"}],onChange:t[42]||(t[42]=e=>C(te).reason+=e.value+"。")})])),_:1}),b(f,{title:"原因",span:24,"title-width":140,"item-render":{}},{default:v((({data:e})=>[b(M,{modelValue:e.reason,"onUpdate:modelValue":t=>e.reason=t},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),b(f,{align:"center","title-align":"left","title-width":140,span:24},{default:v((()=>[b(z,{type:"submit",status:"primary",onClick:t[43]||(t[43]=e=>C(O)("至少勾选一条做核验。核验拒绝必须填写原因。").then((()=>{C(te).status="",C(te).reason=""})))},{default:v((()=>[R(" 确认添加 ")])),_:1})])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue"]),b(A,{modelValue:C(ee).showT1Selector,"onUpdate:modelValue":t[48]||(t[48]=e=>C(ee).showT1Selector=e),title:"更新一级商","min-width":"600","min-height":"300",resize:"","destroy-on-close":""},{default:v((()=>[b(c,{"title-align":"right","title-width":"100",onSubmit:t[47]||(t[47]=e=>C(ee).showT1Selector=!1)},{default:v((()=>[b(f,{field:"t1Selector",title:"一级商",span:20,"item-render":{}},{default:v((()=>[b(r,{transfer:""})])),_:1}),b(f,{title:"备注",span:20,"item-render":{}},{default:v((()=>[b(M)])),_:1}),b(f,{align:"center","title-align":"left",span:24},{default:v((()=>[b(z,{type:"submit",status:"primary",onClick:t[46]||(t[46]=e=>C(O)("如果有勾选，则更新勾选数据的一级商\n                    如果没有勾选，则会按照查询条件批量更新所有符合的数据\n                    核验通过状态的数据不能更新"))},{default:v((()=>[R(" 确认更新一级商 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),b(A,{modelValue:C(ee).showInventoryCertSelector,"onUpdate:modelValue":t[49]||(t[49]=e=>C(ee).showInventoryCertSelector=e),title:"库存凭证",width:"90%",resize:"","destroy-on-close":""},{default:v((()=>[b(c,{"title-align":"right","title-width":"100"},{default:v((()=>[b(f,{title:"库存凭证","title-align":"left","title-width":200,span:24,"title-prefix":{icon:"vxe-icon-question-circle-fill",content:"上传的附件需要重命名，格式为时间戳+人名+省份。\n            商务经理可按省份可见，进口商务按上传人可见。\n            如果商务做了提交操作，附件不允许删除，也不可以新增。\n            数据团队也可以上传库存凭证。"}}),b(f,{span:24},{default:v((()=>[b(H,{"enable-insert":C(a)||C(n),"enable-remove":C(a)||C(n),"show-province":"1"===C(X)},null,8,["enable-insert","enable-remove","show-province"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),b(A,{modelValue:C(ee).showFinanceSelector,"onUpdate:modelValue":t[50]||(t[50]=e=>C(ee).showFinanceSelector=e),title:"财务审核凭证",width:"90%","min-width":"600","min-height":"300",resize:"","destroy-on-close":""},{default:v((()=>[b(c,{"title-align":"right","title-width":"100"},{default:v((()=>[b(f,{span:24},{default:v((()=>[b(H,{"enable-insert":C(d),"enable-remove":C(d)},null,8,["enable-insert","enable-remove"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),b(A,{modelValue:C(ee).showAppealSelector,"onUpdate:modelValue":t[53]||(t[53]=e=>C(ee).showAppealSelector=e),title:"申诉原因填写",width:"50%","min-width":"600","min-height":"300",resize:"","destroy-on-close":""},{default:v((()=>[b(c,{"title-align":"right","title-width":"100",onSubmit:t[52]||(t[52]=e=>C(ee).showAppealSelector=!1)},{default:v((()=>[b(f,{title:"申诉原因",span:24,"item-render":{}},{default:v((()=>[b(M,{"model-value":""})])),_:1}),b(f,{align:"center","title-align":"left",span:24},{default:v((()=>[b(z,{type:"submit",status:"primary",onClick:t[51]||(t[51]=e=>C(O)("确认后，系统将申诉原因保存，并把数据提交。"))},{default:v((()=>[R(" 确认申诉 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}}),[["__file","C:/Users/ThinkPad/source/Bonbonniere/bonbon-vue/src/views/c-payment/FactoryPriceReduceCalculate.vue"]]);export{L as default};
